// Generated by CoffeeScript 1.7.1
(function() {
  var app, checkSites, express, fs, http, interval, intervalId, minutesCount, path, port, sitesPath, storage;

  http = require('http');

  express = require('express');

  path = require('path');

  fs = require('fs');

  sitesPath = path.join(__dirname, '../config', 'sites.json');

  storage = require("./storage");

  checkSites = require("./check");

  app = express();

  app.use(express["static"](path.join(__dirname + '/../public')));

  app.use(express["static"](path.join(__dirname + '/../bower_components')));

  port = Number(process.env.PORT || 5000);

  app.get('/', function(req, res) {
    console.log("GET index");
    return res.render('index');
  });

  app.get('/sites', function(req, response) {
    console.log("GET sites");
    response.header("Content-Type", "application/json");
    return response.send(storage.json());
  });

  minutesCount = 5;

  interval = 60 * 1000 * minutesCount;

  intervalId = setInterval(checkSites, interval);

  checkSites();

  app.listen(port);

  console.log("started on port: " + port);

}).call(this);
